"use strict";!function(){function e(){d=!0,c&&n(c)}function t(e){if(e.data===YT.PlayerState.PLAYING&&c)return o(c),c=null,!0;i.emit("updatevideo",{state:e.data,time:u.getCurrentTime()})}function a(e){i.emit("updateplaybackrate",e.data)}function n(e){if(void 0===e)return!1;void 0!==u&&d?(l.innerHTML=e.title,r&&null!==s&&(clearInterval(s),s=null),u.loadVideoById(e.id,e.time,"default"),u.setPlaybackRate(e.rate),r&&(s=setInterval(function(){i.emit("syncvideo",{time:u.getCurrentTime(),ping:Date.now()})},1500))):c=e}function o(e){switch(e.state){case YT.PlayerState.PLAYING:u.seekTo(e.time,!0),u.playVideo();break;case YT.PlayerState.PAUSED:u.pauseVideo();break;case YT.PlayerState.ENDED:u.stopVideo();break;case YT.PlayerState.BUFFERING:u.seekTo(e.time,!0)}}var i=io("http://localhost:8080"),l=document.getElementById("video-title"),u=void 0,r=!0,d=!1,c=null,s=null;window.onYouTubeIframeAPIReady=function(){u=new YT.Player("player",{width:560,height:315,playerVars:{autohide:!0,autoplay:!1,controls:!0,iv_load_policy:3,rel:!1},events:{onReady:e,onStateChange:t,onPlaybackRateChange:a}})},i.on("startvideo",n),i.on("queuevideo",n),i.on("updatevideo",o),i.on("updateplaybackrate",function(e){return u.setPlaybackRate(e)}),i.on("syncvideo",function(e){console.log("synced ~"+(Date.now()-e.pong)+"ms ago.."),e.time+=Math.abs(Date.now()-e.pong)/1e3,console.log("interpolated: "+e.time),console.log("player diff: "+(e.time-u.getCurrentTime())),e.time-u.getCurrentTime()>.5&&(u.seekTo(e.time),console.log("synced"))}),document.getElementById("queue-video").addEventListener("submit",function(e){e.preventDefault();var t=document.getElementById("video-url"),a=t.value,n=a.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);n&&fetch("https://noembed.com/embed?url="+a,{method:"get"}).then(function(e){return e.json()}).then(function(e){i.emit("queuevideo",{id:n[2],title:e.title,url:e.url,thumbnail:e.thumbnail_url}),t.value=""})["catch"](function(e){console.log(e)})})}();
//# sourceMappingURL=script.min.js.map